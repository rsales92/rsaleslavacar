<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSales Lavacar - Cat√°logo de Servi√ßos</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* BOT√ÉO */
        .details-btn {
            background: linear-gradient(135deg, #0b5ed7, #084298);
            color: #fff;
            border: none;
            padding: 7px 14px;
            font-size: 13px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 8px;
            transition: all 0.3s ease;
        }

        .details-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* MODAL OVERLAY */
        .details-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.75);
            z-index: 3000;

            display: none;
            justify-content: center;
            align-items: center;
        }

        /* ATIVO */
        .details-modal-overlay.active {
            display: flex;
        }

        /* MODAL BOX */
        .details-modal {
            background: #fff;
            padding: 22px 24px 24px;
            border-radius: 12px;
            max-width: 420px;
            width: 92%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            position: relative;

            animation: modalScale 0.25s ease;
        }

        /* T√çTULO */
        .details-modal h3 {
            margin-top: 0;
            margin-bottom: 12px;
            color: #b30000;
            font-size: 1.25em;
            text-align: center;
        }

        /* TEXTO */
        .details-modal p {
            font-size: 0.95em;
            line-height: 1.6;
            color: #333;
            max-height: 320px;
            overflow-y: auto;
        }

        /* FECHAR */
        .details-modal .close-details {
            position: absolute;
            top: 10px;
            right: 14px;
            font-size: 24px;
            cursor: pointer;
            color: #444;
            transition: 0.2s;
        }

        .details-modal .close-details:hover {
            color: #b30000;
        }

        @keyframes modalScale {
            from {
                transform: scale(0.9);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        :root {
            --primary-red: #dc3545;
            --dark-red: #c82333;
            --light-grey: #f8f9fa;
            --medium-grey: #e9ecef;
            --dark-grey: #343a40;
            --black: #212529;
            --white: #ffffff;
            --blue-light: #e6f7ff;
            --blue-dark: #007bff;
            --green: #28a745;
            --dark-green: #1e7e34;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--light-grey);
            color: var(--black);
            line-height: 1.6;
            overflow-x: hidden;
            padding-bottom: 70px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
            box-sizing: border-box;
        }
        header {
            background-color: var(--black);
            color: var(--white);
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 700;
            color: var(--primary-red);
        }
        main {
            padding: 40px 0;
            max-width: 900px;
            margin: 40px auto;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        h2 { color: var(--black); text-align: center; margin-bottom: 20px; font-weight: 700; font-size: 2em; }
        .info-text { text-align: center; margin-bottom: 30px; font-size: 1.1em; color: var(--dark-grey); padding: 10px 0; border-bottom: 1px solid var(--medium-grey); border-top: 1px solid var(--medium-grey); }
        #car-selection .button-group { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-top: 30px; margin-bottom: 30px; }
        .car-type-btn, .back-button { background-color: var(--primary-red); color: var(--white); border: none; padding: 12px 25px; font-size: 16px; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease, transform 0.2s ease; flex: 1 1 auto; max-width: 200px; font-weight: 600; }
        .car-type-btn:hover, .back-button:hover { background-color: var(--dark-red); transform: translateY(-2px); }
        .car-type-btn.active { background-color: var(--dark-red); border: 2px solid var(--primary-red); }

        /* Servi√ßos Avulsos */
        .additional-services { padding: 0 20px; padding-top: 10px; margin-bottom: 40px; }
        .additional-services h3 { color: var(--black); font-size: 24px; margin-bottom: 15px; text-align: center; font-weight: 700; border-bottom: 2px solid var(--medium-grey); padding-bottom: 10px; }
        .service-item { 
            background-color: var(--light-grey); 
            border: 1px solid var(--medium-grey); 
            border-radius: 5px; 
            padding: 15px; 
            margin-bottom: 15px; 
            display: flex; 
            align-items: flex-start; 
            gap: 15px; 
            transition: background-color 0.3s, border-color 0.3s;
        }
        
        /* Destaque para o servi√ßo selecionado */
        .service-item.selected {
            background-color: var(--blue-light);
            border: 2px solid var(--primary-red);
            box-shadow: 0 0 5px rgba(220, 53, 69, 0.5);
        }

        .service-item input[type="checkbox"] { 
            min-width: 20px; 
            height: 20px; 
            cursor: pointer; 
            accent-color: var(--primary-red); 
            margin-top: 5px; 
        }
        .service-details { flex-grow: 1; }
        .service-item h4 { color: var(--primary-red); margin-top: 0; margin-bottom: 5px; font-size: 1.2em; font-weight: 600; }
        .service-item .price { font-weight: bold; color: var(--black); font-size: 1.1em; display: block; margin-top: 5px; }
        .service-item p { font-size: 0.95em; color: var(--dark-grey); margin-bottom: 0; }

        .back-button { display: block; width: fit-content; margin: 30px auto 0; }
        
        /* --- ESTILOS DO MODAL/POPUP CENTRALIZADA --- */
        .floating-cart-wrapper {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        #floating-cart-icon {
            background-color: var(--white);
            color: var(--primary-red);
            border: 2px solid var(--primary-red);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s, transform 0.2s, color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-left: auto;
        }

        #floating-cart-icon:hover {
            background-color: var(--light-grey);
            color: var(--dark-red);
            transform: scale(1.05);
        }
        
        /* Anima√ß√£o */
        .cart-pulse {
            animation: pulse-ring 0.6s ease-out;
        }
        
        @keyframes pulse-ring {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0px rgba(255, 0, 0, 0.7);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 0 0 10px rgba(255, 0, 0, 0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }
        }

        #cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--green);
            color: var(--white);
            font-size: 12px;
            font-weight: 700;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        /* Modal do Carrinho (Fundo Escurecido) */
        .cart-modal-overlay {
            display: none; 
            position: fixed;
            z-index: 1001; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6); 
            justify-content: center;
            align-items: center;
        }

        .cart-modal-overlay.active {
            display: flex; 
        }

        /* Conte√∫do do Modal (A Popup Centralizada) */
        #cart-summary {
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            width: 90%; 
            max-width: 400px; 
            max-height: 90vh; 
            overflow-y: auto;
            transform: scale(0.95);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            border-top: 4px solid var(--primary-red);
            position: relative;
        }

        .cart-modal-overlay.active #cart-summary {
            transform: scale(1);
            opacity: 1;
        }

        #cart-summary h3 { 
            color: var(--black); 
            font-size: 18px; 
            margin-top: 0; 
            margin-bottom: 10px; 
            border-bottom: 1px dashed var(--dark-grey); 
            padding-bottom: 5px; 
            /* Estilo para centralizar o t√≠tulo do carrinho */
            text-align: center; 
        }
        #cart-items { list-style: none; padding: 0; margin-bottom: 15px; }
        #cart-items li { 
            font-size: 0.9em; 
            margin-bottom: 8px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            color: var(--dark-grey); 
            border-bottom: 1px dotted var(--medium-grey);
            padding-bottom: 5px;
        }
        #cart-items li span:first-child { max-width: 60%; } 
        #cart-items li strong { color: var(--black); font-weight: 600; margin-right: 10px; }
        
        .remove-item-btn {
            background: none;
            border: none;
            color: var(--primary-red);
            cursor: pointer;
            font-size: 1.1em;
            padding: 0 5px;
            transition: color 0.2s;
            line-height: 1;
            margin-left: 5px;
        }
        .remove-item-btn:hover {
            color: var(--dark-red);
        }

        .cart-subtotal {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--dark-grey);
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-top: 1px dashed var(--medium-grey);
        }

        .cart-discount {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--green); 
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
        }

        #cart-total { 
            font-size: 1.3em; 
            font-weight: 700; 
            color: var(--black); 
            display: flex; 
            justify-content: space-between; 
            padding: 10px 0; 
            border-top: 2px solid var(--primary-red); 
            margin-bottom: 5px;
        }
        
        .payment-note {
            font-size: 0.9em;
            color: var(--dark-red);
            text-align: center;
            margin-bottom: 15px;
            padding: 5px;
            background-color: #ffe6e6;
            border-radius: 3px;
            border: 1px solid var(--dark-red);
        }

        .checkout-button {
            display: block;
            width: 100%;
            max-width: none;
            background-color: var(--green);
            margin-top: 15px;
            border: none;
            padding: 10px;
            color: var(--white);
            font-weight: 600;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .checkout-button:hover { background-color: var(--dark-green); }
        .checkout-button:disabled { background-color: #6c757d; cursor: not-allowed; }

        .close-modal {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            font-weight: bold;
            color: var(--dark-grey);
            cursor: pointer;
            transition: color 0.2s;
        }
        .close-modal:hover {
            color: var(--primary-red);
        }

        .appointment-message {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background-color: var(--blue-light);
            border: 1px solid #b3e0ff;
            border-radius: 5px;
            font-size: 1.1em;
            color: var(--blue-dark);
        }
        .appointment-message a {
            color: var(--blue-dark);
            font-weight: bold;
            text-decoration: none;
        }
        .appointment-message a:hover {
            text-decoration: underline;
        }

        @media (max-width: 400px) {
            .floating-cart-wrapper {
                bottom: 10px;
                right: 10px;
            }
            #floating-cart-icon {
                width: 50px;
                height: 50px;
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>RSales Lavacar - Cat√°logo</h1>
        </div>
    </header>
    
    <main class="container">
        <section id="car-selection">
            <p class="info-text">
                Selecione a categoria do seu ve√≠culo para visualizar os pre√ßos dos servi√ßos dispon√≠veis.
            </p>
            <h2>Selecione o tipo de carro:</h2>
            <div class="button-group">
                <button class="car-type-btn" data-car="HATCH">HATCH</button>
                <button class="car-type-btn" data-car="SEDAN">SEDAN</button>
                <button class="car-type-btn" data-car="SUV">SUV</button>
                <button class="car-type-btn" data-car="PICAPE">PICAPE</button>
                <img src="logo.jpeg" alt="RSales Lavacar" style="max-width: 440px; width: 100%; height: auto;">
            </div>
        </section>

        <section id="services-display" style="display: none;">
            <h2 id="car-type-title"></h2>
            <div id="services-content">
            </div>
            
            <button id="back-to-selection" class="back-button">Voltar √† Sele√ß√£o de Carros</button>
        </section>
    </main>

    <div id="cart-modal" class="cart-modal-overlay">
    </div>

    <section class="floating-cart-wrapper">
        <div id="floating-cart-icon">
            <i class="fas fa-shopping-cart"></i>
            <span id="cart-count">0</span>
        </div>
    </section>
    
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

    <script>
        // ESTRUTURA DE DADOS (APENAS SERVI√áOS AVULSOS)
        const carData = {
            "SUV": {
                "additional_services": [
                    {"name": "Lavagem Express", "description": "Limpeza r√°pida e eficiente para a manuten√ß√£o do dia a dia.", "price": "R$ 90,00"},
                    {"name": "Lavagem Completa", "description": "Limpeza interna e externa completa, com acabamento caprichado e excelente custo-benef√≠cio.", "price": "R$ 115,00"},
                    {"name": "Lavagem Detalhada + Cera Tradicional", "description": "Limpeza completa com aplica√ß√£o de cera para brilho, prote√ß√£o leve e toque suave na pintura.", "price": "R$ 150,00"},
                    {"name": "Lavagem Detalhada + Cera Premium", "description": "Limpeza completa com cera premium, oferecendo alto brilho, maior prote√ß√£o e intensa hidrorepel√™ncia.", "price": "R$ 180,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos externos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos externos (para-choques, frisos, retrovisores), com realce da cor original, utilizando produtos de alta durabilidade.", "price": "R$ 60,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos internos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos internos (painel, portas, consoles), com realce da cor original e prote√ß√£o UV.", "price": "R$ 80,00"},
                    {"name": "Descontamina√ß√£o de pintura", "description": "Removemos impurezas profundas da pintura, incluindo res√≠duos met√°licos, seiva, poluentes e pulveriza√ß√£o de tinta. O processo devolve o toque liso e real√ßa o brilho da superf√≠cie.", "price": "R$ 500,00"},
                    {"name": "Cristaliza√ß√£o dos vidros", "description": "Limpeza profunda dos vidros externos, remo√ß√£o de res√≠duos como chuva √°cida, gordura e polui√ß√£o, com aplica√ß√£o de selante hidrof√≥bico para repelir a √°gua.", "price": "R$ 230,00"},
                    {"name": "Higieniza√ß√£o e hidrata√ß√£o dos bancos de couro", "description": "Limpeza e hidrata√ß√£o profunda para manter seus bancos de couro macios, com remo√ß√£o de sujeira e revitaliza√ß√£o do material.", "price": "R$ 150,00"},
                    {"name": "Enceramento T√©cnico (Incluso Lavagem + Descontamina√ß√£o)", "description": "Enceramento da lataria, removendo manchas e riscos leves, restaurando o brilho e a cor do ve√≠culo. Ideal para carros que perderam o brilho com o tempo.", "price": "R$ 600,00"},
                    {"name": "Revitaliza√ß√£o dos far√≥is (amarelados ou opacos)", "description": "Renova o brilho e remove o amarelado dos far√≥is, melhorando a ilumina√ß√£o e a est√©tica do ve√≠culo.", "price": "R$ 250,00"},
                    {"name": "Lavagem de Motor (a Seco)", "description": "Processo detalhado e seguro que remove sujeira, poeira e res√≠duos do cofre e componentes do motor sem utilizar √°gua em excesso", "price": "R$ 250,00"}
                ],
            },
            "HATCH": {
                "additional_services": [
                    {"name": "Lavagem Express", "description": "Limpeza r√°pida e eficiente para a manuten√ß√£o do dia a dia.", "price": "R$ 65,00"},
                    {"name": "Lavagem Completa", "description": "Limpeza interna e externa completa, com acabamento caprichado e excelente custo-benef√≠cio.", "price": "R$ 85,00"},
                    {"name": "Lavagem Detalhada + Cera Tradicional", "description": "Limpeza completa com aplica√ß√£o de cera para brilho, prote√ß√£o leve e toque suave na pintura.", "price": "R$ 120,00"},
                    {"name": "Lavagem Detalhada + Cera Premium", "description": "Limpeza completa com cera premium, oferecendo alto brilho, maior prote√ß√£o e intensa hidrorepel√™ncia.", "price": "R$ 150,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos externos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos externos.", "price": "R$ 40,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos internos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos internos (painel, portas, consoles).", "price": "R$ 60,00"},
                    {"name": "Descontamina√ß√£o de pintura", "description": "Removemos impurezas profundas da pintura, incluindo res√≠duos met√°licos, seiva, poluentes e pulveriza√ß√£o de tinta. O processo devolve o toque liso e real√ßa o brilho da superf√≠cie.", "price": "R$ 300,00"},
                    {"name": "Cristaliza√ß√£o dos vidros", "description": "Limpeza profunda dos vidros, remo√ß√£o de chuva √°cida e aplica√ß√£o de selante hidrof√≥bico.", "price": "R$ 230,00"},
                    {"name": "Higieniza√ß√£o e hidrata√ß√£o dos bancos de couro", "description": "Limpeza e hidrata√ß√£o profunda para manter seus bancos de couro macios.", "price": "R$ 120,00"},
                    {"name": "Enceramento T√©cnico (Incluso Lavagem + Descontamina√ß√£o)", "description": "Enceramento da lataria, removendo manchas e riscos leves e recuperando o brilho.", "price": "R$ 400,00"},
                    {"name": "Revitaliza√ß√£o dos far√≥is (amarelados ou opacos)", "description": "Renova o brilho e remove o amarelado dos far√≥is.", "price": "R$ 250,00"},
                    {"name": "Lavagem de Motor (a Seco)", "description": "Processo detalhado e seguro que remove sujeira, poeira e res√≠duos do cofre e componentes do motor sem utilizar √°gua em excesso", "price": "R$ 250,00"}
                ],
            },
            "SEDAN": {
                "additional_services": [
                    {"name": "Lavagem Express", "description": "Limpeza r√°pida e eficiente para a manuten√ß√£o do dia a dia.", "price": "R$ 75,00"},
                    {"name": "Lavagem Completa", "description": "Limpeza interna e externa completa, com acabamento caprichado e excelente custo-benef√≠cio.", "price": "R$ 95,00"},
                    {"name": "Lavagem Detalhada + Cera Tradicional", "description": "Limpeza completa com aplica√ß√£o de cera para brilho, prote√ß√£o leve e toque suave na pintura.", "price": "R$ 130,00"},
                    {"name": "Lavagem Detalhada + Cera Premium", "description": "Limpeza completa com cera premium, oferecendo alto brilho, maior prote√ß√£o e intensa hidrorepel√™ncia.", "price": "R$ 160,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos externos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos externos.", "price": "R$ 40,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos internos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos internos (painel, portas, consoles).", "price": "R$ 60,00"},
                    {"name": "Descontamina√ß√£o de pintura", "description": "Removemos impurezas profundas da pintura, incluindo res√≠duos met√°licos, seiva, poluentes e pulveriza√ß√£o de tinta. O processo devolve o toque liso e real√ßa o brilho da superf√≠cie.", "price": "R$ 400,00"},
                    {"name": "Cristaliza√ß√£o dos vidros", "description": "Limpeza profunda dos vidros, remo√ß√£o de chuva √°cida e aplica√ß√£o de selante hidrof√≥bico.", "price": "R$ 230,00"},
                    {"name": "Higieniza√ß√£o e hidrata√ß√£o dos bancos de couro", "description": "Limpeza e hidrata√ß√£o profunda para manter seus bancos de couro macios.", "price": "R$ 120,00"},
                    {"name": "Enceramento T√©cnico (Incluso Lavagem + Descontamina√ß√£o)", "description": "Enceramento da lataria, removendo manchas e riscos leves e recuperando o brilho.", "price": "R$ 500,00"},
                    {"name": "Revitaliza√ß√£o dos far√≥is (amarelados ou opacos)", "description": "Renova o brilho e remove o amarelado dos far√≥is.", "price": "R$ 250,00"},
                    {"name": "Lavagem de Motor (a Seco)", "description": "Processo detalhado e seguro que remove sujeira, poeira e res√≠duos do cofre e componentes do motor sem utilizar √°gua em excesso", "price": "R$ 250,00"}
                ],
            },
            "PICAPE": {
                "additional_services": [
                    {"name": "Lavagem Express", "description": "Limpeza r√°pida e eficiente para a manuten√ß√£o do dia a dia.", "price": "R$ 100,00"},
                    {"name": "Lavagem Completa", "description": "Limpeza interna e externa completa, com acabamento caprichado e excelente custo-benef√≠cio.", "price": "R$ 130,00"},
                    {"name": "Lavagem Detalhada + Cera Tradicional", "description": "Limpeza completa com aplica√ß√£o de cera para brilho, prote√ß√£o leve e toque suave na pintura.", "price": "R$ 170,00"},
                    {"name": "Lavagem Detalhada + Cera Premium", "description": "Limpeza completa com cera premium, oferecendo alto brilho, maior prote√ß√£o e intensa hidrorepel√™ncia.", "price": "R$ 200,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos externos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos externos.", "price": "R$ 40,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos internos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos internos (painel, portas, consoles).", "price": "R$ 60,00"},
                    {"name": "Descontamina√ß√£o de pintura", "description": "Removemos impurezas profundas da pintura, incluindo res√≠duos met√°licos, seiva, poluentes e pulveriza√ß√£o de tinta. O processo devolve o toque liso e real√ßa o brilho da superf√≠cie.", "price": "R$ 600,00"},
                    {"name": "Cristaliza√ß√£o dos vidros", "description": "Limpeza profunda dos vidros, remo√ß√£o de chuva √°cida e aplica√ß√£o de selante hidrof√≥bico.", "price": "R$ 230,00"},
                    {"name": "Higieniza√ß√£o e hidrata√ß√£o dos bancos de couro", "description": "Limpeza e hidrata√ß√£o profunda para manter seus bancos de couro macios.", "price": "R$ 120,00"},
                    {"name": "Enceramento T√©cnico (Incluso Lavagem + Descontamina√ß√£o)", "description": "Enceramento da lataria, removendo manchas e riscos leves e recuperando o brilho.", "price": "R$ 700,00"},
                    {"name": "Revitaliza√ß√£o dos far√≥is (amarelados ou opacos)", "description": "Renova o brilho e remove o amarelado dos far√≥is.", "price": "R$ 250,00"},
                    {"name": "Lavagem de Motor (a Seco)", "description": "Processo detalhado e seguro que remove sujeira, poeira e res√≠duos do cofre e componentes do motor sem utilizar √°gua em excesso", "price": "R$ 250,00"}
                ],
            }
        };
        function getServiceKey(name) {
            name = name.toLowerCase();

            if (name.includes('express')) return 'express';
            if (name.includes('completa')) return 'completa';
            if (name.includes('tradicional')) return 'detalhadaTradicional';
            if (name.includes('premium')) return 'detalhadaPremium';                
            if (name.includes('pl√°sticos externos')) return 'plasticosExternos';
            if (name.includes('pl√°sticos internos')) return 'plasticosInternos';
            if (name.includes('descontamina√ß√£o de pintura')) return 'descontaminacao';
            if (name.includes('bancos')) return 'bancos';
            if (name.includes('enceramento')) return 'enceramento';
            if (name.includes('motor')) return 'motor';
            if (name.includes('far√≥is') || name.includes('farois')) return 'farol';
            if (name.includes('vidros')) return 'vidros';

            return 'express';
        }

        const aplicarRegrasSelecao = () => {
            const checkboxes = document.querySelectorAll('#services-content input[type="checkbox"]');

            let lavagemSelecionada = false;
            let descontaminacaoSelecionada = false;
            let enceramentoSelecionado = false;

            checkboxes.forEach(cb => {
                if (cb.checked) {
                    const key = getServiceKey(cb.dataset.name);

                    if (['express','completa','detalhadaTradicional','detalhadaPremium'].includes(key)) {
                        lavagemSelecionada = true;
                    }
                    if (key === 'descontaminacao') descontaminacaoSelecionada = true;
                    if (key === 'enceramento') enceramentoSelecionado = true;
                }
            });

            checkboxes.forEach(cb => {
                const key = getServiceKey(cb.dataset.name);
                const wrapper = cb.closest('.service-item');

                cb.disabled = false;
                wrapper.classList.remove('disabled');

                let motivo = '';

                if (lavagemSelecionada && !cb.checked) {
                    if (
                        key === 'descontaminacao' ||
                        key === 'enceramento' ||
                        ['express','completa','detalhadaTradicional','detalhadaPremium'].includes(key)
                    ) {
                        cb.disabled = true;
                        motivo = 'J√° existe uma lavagem selecionada';
                    }
                }

                if (descontaminacaoSelecionada && !cb.checked) {
                    if (
                        key === 'enceramento' ||
                        ['express','completa','detalhadaTradicional','detalhadaPremium'].includes(key)
                    ) {
                        cb.disabled = true;
                        motivo = 'Servi√ßo incompat√≠vel com descontamina√ß√£o';
                    }
                }

                if (enceramentoSelecionado && !cb.checked) {
                    if (
                        key === 'descontaminacao' ||
                        ['express','completa','detalhadaTradicional','detalhadaPremium'].includes(key)
                    ) {
                        cb.disabled = true;
                        motivo = 'Servi√ßo incompat√≠vel com enceramento';
                    }
                }

                if (cb.disabled) {
                    wrapper.classList.add('disabled');

                    if (!wrapper.querySelector('.lock-tooltip')) {
                        const span = document.createElement('span');
                        span.className = 'lock-tooltip';
                        span.innerText = motivo;
                        wrapper.querySelector('.service-details').appendChild(span);
                    } else {
                        wrapper.querySelector('.lock-tooltip').innerText = motivo;
                    }
                } else {
                    const tooltip = wrapper.querySelector('.lock-tooltip');
                    if (tooltip) tooltip.remove();
                }
            });
        };



        document.addEventListener('DOMContentLoaded', () => {
            const carTypeButtons = document.querySelectorAll('.car-type-btn');
            const backButton = document.getElementById('back-to-selection');
            const carSelectionSection = document.getElementById('car-selection');
            const servicesDisplaySection = document.getElementById('services-display');
            const carTypeTitle = document.getElementById('car-type-title');
            const servicesContent = document.getElementById('services-content');
            
            const floatingCartIcon = document.getElementById('floating-cart-icon');
            const cartCountSpan = document.getElementById('cart-count');
            
            const cartModalOverlay = document.getElementById('cart-modal');
            let cartItemsList;
            let cartSummaryElement; 
            let checkoutButton;

            let cart = [];
            let currentCarType = '';
            let nextItemId = 0; 
            
            let currentSubtotal = 0; // Armazena o subtotal num√©rico
            let currentTotal = 0;   // Armazena o total num√©rico

            const WHATSAPP_NUMBER = '5544997063542';
            const DISCOUNT_RATE = 0.05; // 5% de desconto

            /**
             * FUN√á√ÉO CR√çTICA: Converte a string de pre√ßo em formato BRL (Ex: R$ 1.000,00) para um float (Ex: 1000.00).
             */
            const formatPrice = (priceText) => {
                // Remove "R$" e qualquer texto que n√£o seja d√≠gito, ponto ou v√≠rgula
                let numStr = priceText.replace(/[^0-9,.]/g, '').trim();
                
                // Trata o caso de "60,00 cada"
                // if (numStr.endsWith('')) {
                //      numStr = numStr.replace('', '').trim();
                // }

                // 1. Remove o separador de milhares (o ponto)
                // Ex: "1.000,00" -> "1000,00"
                numStr = numStr.replace(/\./g, ''); 
                
                // 2. Converte o separador decimal (a v√≠rgula) para o ponto decimal
                // Ex: "1000,00" -> "1000.00"
                numStr = numStr.replace(',', '.');
                
                return parseFloat(numStr) || 0;
            };

            /**
             * FUN√á√ÉO CR√çTICA: Formata um n√∫mero float para o formato de moeda BRL (R$ 1.000,00).
             */
            const formatToBRL = (number) => {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                }).format(number);
            };

            const animateCart = () => {
                floatingCartIcon.classList.remove('cart-pulse');
                void floatingCartIcon.offsetWidth; 
                floatingCartIcon.classList.add('cart-pulse');
            }

            const toggleFloatingCart = () => {
                if (cartModalOverlay.classList.contains('active')) {
                    cartModalOverlay.classList.remove('active');
                } else {
                    cartModalOverlay.classList.add('active');
                }
            };
            
            const createCartSummaryHTML = () => {
                const summaryHTML = `
                    <section id="cart-summary">
                        <span class="close-modal">&times;</span>
                        <h3>üõí Carrinho de Servi√ßos</h3>
                        <ul id="cart-items">
                            <li>Nenhum servi√ßo avulso selecionado.</li>
                        </ul>
                        <div id="cart-summary-totals"> 
                        </div>
                        
                        <p class="payment-note">
                            Valores v√°lidos para pagamento em Dinheiro ou PIX
                        </p>
                        <button id="checkout-button" class="checkout-button" disabled>Agendar</button>
                    </section>
                `;
                
                cartModalOverlay.innerHTML = summaryHTML;
                
                cartItemsList = document.getElementById('cart-items');
                cartSummaryElement = document.getElementById('cart-summary-totals');
                checkoutButton = document.getElementById('checkout-button');

                checkoutButton.addEventListener('click', handleCheckout);
                document.querySelector('.close-modal').addEventListener('click', toggleFloatingCart);
                
                cartModalOverlay.addEventListener('click', (event) => {
                    if (event.target === cartModalOverlay) {
                        toggleFloatingCart();
                    }
                });
            };

            const removeItem = (itemId) => {
                const index = cart.findIndex(item => item.id === itemId);
                if (index > -1) {
                    const item = cart[index];
                    const checkbox = document.getElementById(item.elementId);
                    
                    if (checkbox) {
                        checkbox.checked = false;
                        checkbox.removeAttribute('data-cart-id');
                        
                        // Remove o destaque do item de servi√ßo
                        const serviceItemDiv = checkbox.closest('.service-item');
                        if (serviceItemDiv) {
                            serviceItemDiv.classList.remove('selected');
                        }
                    }
                    
                    cart.splice(index, 1);
                    renderCart();
                }
            };
            
            const renderCart = () => {
                if (!cartSummaryElement) {
                    createCartSummaryHTML();
                }

                cartItemsList.innerHTML = '';
                currentSubtotal = 0;
                let discountAmount = 0;
                const itemCount = cart.length;

                if (itemCount === 0) {
                    cartItemsList.innerHTML = '<li>Nenhum servi√ßo avulso selecionado.</li>';
                    checkoutButton.disabled = true;
                } else {
                    cart.forEach(item => {
                        const li = document.createElement('li');
                        li.setAttribute('data-id', item.id); 
                        li.innerHTML = `
                            <span>${item.name}</span>
                            <div>
                                <strong>${formatToBRL(item.price)}</strong>
                                <button class="remove-item-btn" data-id="${item.id}" title="Remover item">&times;</button>
                            </div>
                        `;
                        cartItemsList.appendChild(li);
                        currentSubtotal += item.price;
                    });
                    checkoutButton.disabled = false;
                    
                    document.querySelectorAll('.remove-item-btn').forEach(button => {
                        button.addEventListener('click', (event) => {
                            const itemId = parseInt(event.target.dataset.id);
                            removeItem(itemId);
                        });
                    });
                }
                
                if (itemCount >= 2) {
                    discountAmount = currentSubtotal * DISCOUNT_RATE;
                    currentTotal = currentSubtotal - discountAmount;
                } else {
                    currentTotal = currentSubtotal;
                }
                
                // Arredondamento para evitar problemas de ponto flutuante no JavaScript
                currentTotal = Math.round(currentTotal * 100) / 100;
                discountAmount = Math.round(discountAmount * 100) / 100;
                currentSubtotal = Math.round(currentSubtotal * 100) / 100;
                
                let totalsHTML = '';
                if (itemCount > 0) {
                    if (discountAmount > 0) {
                        totalsHTML += `
                            <div class="cart-subtotal">
                                <span>Subtotal:</span>
                                <span>${formatToBRL(currentSubtotal)}</span>
                            </div>
                            <div class="cart-discount">
                                <span>Desconto (5% em ${itemCount} itens):</span>
                                <span>-${formatToBRL(discountAmount)}</span>
                            </div>
                        `;
                    }
                }
                
                totalsHTML += `
                    <div id="cart-total">
                        <span>Total:</span>
                        <span id="total-price">${formatToBRL(currentTotal)}</span>
                    </div>
                `;
                
                cartSummaryElement.innerHTML = totalsHTML;

                cartCountSpan.textContent = itemCount;
                floatingCartIcon.style.display = 'flex';
            };


            const handleServiceChange = (event) => {
                const checkbox = event.target;
                const serviceItemDiv = checkbox.closest('.service-item');
                const serviceName = checkbox.dataset.name;
                const servicePrice = formatPrice(checkbox.dataset.price); // Valor num√©rico

                if (checkbox.checked) {
                    serviceItemDiv.classList.add('selected'); // Adiciona classe de destaque

                    const serviceId = nextItemId++;
                    cart.push({
                        id: serviceId, 
                        type: 'service', 
                        name: serviceName,
                        price: servicePrice,
                        elementId: checkbox.id 
                    });
                    
                    checkbox.setAttribute('data-cart-id', serviceId); 

                    animateCart();
                } else {
                    serviceItemDiv.classList.remove('selected'); // Remove classe de destaque

                    const cartId = parseInt(checkbox.getAttribute('data-cart-id'));
                    const index = cart.findIndex(item => item.id === cartId);

                    if (index > -1) {
                        cart.splice(index, 1);
                        checkbox.removeAttribute('data-cart-id');
                    }
                }

                renderCart();
                aplicarRegrasSelecao();
            };
            
            /**
             * FUN√á√ÉO CR√çTICA: Gera√ß√£o da mensagem de checkout
             */
            const handleCheckout = () => {
                // Usamos as vari√°veis num√©ricas globais atualizadas pelo renderCart
                const finalTotal = currentTotal;
                const subtotalValue = currentSubtotal;
                const discountAmount = subtotalValue * DISCOUNT_RATE;

                const itemsList = cart.map(item => `- ${item.name} (${formatToBRL(item.price)})`).join('\n');
                
                let messageBody = `Ol√°, gostaria de agendar os seguintes servi√ßos para meu ve√≠culo ${currentCarType}:\n\n${itemsList}\n`;

                if (cart.length >= 2) {
                    messageBody += `\nSubtotal: ${formatToBRL(subtotalValue)}\n`;
                    messageBody += `Desconto (5% por m√∫ltiplos itens): -${formatToBRL(discountAmount)}\n`;
                }

                messageBody += `\nTotal: ${formatToBRL(finalTotal)}`;
                
                messageBody += `\n\n*Favor confirmar a disponibilidade de hor√°rio.*`;
                
                const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(messageBody)}`;
                window.open(whatsappUrl, '_blank');
            };


            const generateServicesHTML = (data) => {
                const services = data.additional_services;
                let html = '';

                // Apenas Servi√ßos Avulsos
                html += `
                    <section class="additional-services">
                        <h3>Monte seu pedido</h3>
                `;

                services.forEach((service, index) => {
                    const id = `service-${currentCarType}-${index}`;
                    const isChecked = cart.some(item => item.name === service.name);
                    const selectedClass = isChecked ? 'selected' : '';

                    // Ajusta a exibi√ß√£o para incluir "cada" no pre√ßo se for o farol
                    let priceDisplay = service.price;
                    if (service.name.includes("Revitaliza√ß√£o dos far√≥is")) {
                        priceDisplay += ' (o par)';
                    }

                    html += `
                        <div class="service-item ${selectedClass}">
                            <input 
                                type="checkbox" 
                                id="${id}" 
                                data-name="${service.name}" 
                                data-price="${service.price}"
                                ${isChecked ? 'checked' : ''}
                            />
                            <div class="service-details">
                                <label for="${id}">
                                    <h4>${service.name}</h4>
                                    <p>${service.description.substring(0, 70)}...</p>

                                    <button 
                                        class="details-btn"
                                        onclick="abrirModal('${getServiceKey(service.name)}')">
                                        MAIS DETALHES
                                    </button>

                                </label>
                                <span class="price">${priceDisplay}</span>
                            </div>
                        </div>
                    `;
                });

                html += `</section>`;
                return html;
            };

            const showServices = (carType) => {
                currentCarType = carType;
                carTypeTitle.textContent = `${carType}`;
                servicesContent.innerHTML = generateServicesHTML(carData[carType]);
                carSelectionSection.style.display = 'none';
                servicesDisplaySection.style.display = 'block';

                document.querySelectorAll('#services-content input[type="checkbox"]').forEach(checkbox => {
                    checkbox.addEventListener('change', handleServiceChange);
                });
                renderCart(); // Atualiza o carrinho ao mudar o tipo de carro
            };
            
            const showCarSelection = () => {
                carSelectionSection.style.display = 'block';
                servicesDisplaySection.style.display = 'none';
                
                // Limpar carrinho e desmarcar tudo ao voltar (opcional, mas recomendado)
                cart = [];
                currentCarType = '';
                renderCart();
                
                // Remove a classe 'active' de todos os bot√µes de sele√ß√£o de carro
                carTypeButtons.forEach(btn => btn.classList.remove('active'));
            };

            carTypeButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const carType = event.target.dataset.car;
                    showServices(carType);

                    // Adiciona a classe 'active' ao bot√£o clicado
                    carTypeButtons.forEach(btn => btn.classList.remove('active'));
                    event.target.classList.add('active');
                });
            });

            backButton.addEventListener('click', showCarSelection);
            floatingCartIcon.addEventListener('click', toggleFloatingCart);
                  
            // Inicializa o modal do carrinho
            createCartSummaryHTML();
            renderCart(); 
            aplicarRegrasSelecao(); // Renderiza o carrinho vazio inicialmente
        });
    </script>
   
    <!-- MODAL MAIS DETALHES -->
<div id="modalDetalhes" class="modal">
  <div class="modal-content">
    <span class="close" onclick="fecharModal()">&times;</span>
    <h2 id="modalTitulo"></h2>
    <ul id="modalLista"></ul>
  </div>
</div>
<style>
        /* Servi√ßo bloqueado */
    .service-item.disabled {
        opacity: 0.55;
        filter: grayscale(100%);
        pointer-events: none;
        position: relative;
    }

    .service-item.disabled::after {
        content: "üîí";
        position: absolute;
        top: 8px;
        right: 10px;
        background: #dc3545;
        color: #fff;
        font-size: 11px;
        padding: 3px 6px;
        border-radius: 6px;
        font-weight: 600;
    }

    .service-item.disabled .lock-tooltip {
        display: block;
    }

    .lock-tooltip {
        display: none;
        font-size: 12px;
        margin-top: 6px;
        color: #b30000;
        font-weight: 600;
    }

    .modal {
     position: fixed;
     inset: 0;
     z-index: 9999;
     background: rgba(0,0,0,0.6);
     backdrop-filter: blur(3px);

     display: none;
     align-items: center;
     justify-content: center;
    }


    .modal-content {
    background: #fff;
    padding: 22px;
    border-radius: 14px;
    max-width: 450px;
    width: 92%;
    animation: zoom .25s ease;
    }

@keyframes zoom {
  from { transform: translateY(15px) scale(0.95); opacity: 0; }
  to { transform: translateY(0) scale(1); opacity: 1; }
}


.close {
  float: right;
  font-size: 28px;
  cursor: pointer;
}

#modalTitulo {
  margin-bottom: 10px;
  color: #111;
  font-size: 22px;
}

#modalLista {
  padding-left: 18px;
}

#modalLista li {
  margin-bottom: 8px;
  font-size: 15px;
}
</style>

<script>
    const servicos = {
    express: {
    titulo: "Lavagem Express",
    itens: [
      "Lavagem externa com shampoo tradicional",
      "Limpeza interna superficial",
      "Limpeza r√°pida de rodas e pneus",
    ]
  },

  completa: {
    titulo: "Lavagem Completa",
    itens: [
      "Pr√©-lavagem desengraxante",
      "Lavagem externa com shampoo de cera",
      "Aspira√ß√£o interna completa",
      "Limpeza de painel, portas e console",
      "Limpeza dos vidros internos e externos",
      "Lavagem de rodas e pneus",
      "Finaliza√ß√£o com brilho nos pneus"
    ]
  },

  detalhadaTradicional: {
    titulo: "Lavagem Detalhada + Cera Tradicional",
    itens: [
      "Lavagem t√©cnica detalhada (incluso pr√©-lavagem)",
      "Limpeza das rodas, caixas de roda e pneus",
      "Aplica√ß√£o de cera tradicional de carnauba",
      "Secagem com toalhas de microfibra",
      "Finaliza√ß√£o com brilho nos pneus"
    ]
  },

  detalhadaPremium: {
    titulo: "Lavagem Detalhada + Cera Premium",
    itens: [
      "Lavagem t√©cnica detalhada (incluso pr√©-lavagem)",
      "Limpeza das rodas, caixas de roda e pneus",
      "Aplica√ß√£o de cera premium de alta durabilidade",
      "Secagem com microfibra especial",
      "Finaliza√ß√£o com brilho nos pneus"
    ]
  },

  plasticosExternos: {
    titulo: "Hidrata√ß√£o dos pl√°sticos externos",
    itens: [
        "Limpeza profunda dos pl√°sticos externos",
        "Descontamina√ß√£o de sujeiras pesadas",
        "Revitaliza√ß√£o da cor original",
        "Prote√ß√£o UV prolongada"
    ]
},

   plasticosInternos: {
    titulo: "Hidrata√ß√£o dos pl√°sticos internos",
    itens: [
        "Limpeza t√©cnica de painel, portas e console",
        "Revitaliza√ß√£o da cor original",
        "Prote√ß√£o UV",
        "Acabamento premium"
    ]
},

descontaminacao: {
  titulo: "Descontamina√ß√£o de pintura",
  itens: [
    "Lavagem Completa",
    "Remo√ß√£o de res√≠duos met√°licos",
    "Remo√ß√£o de seiva, polui√ß√£o, pulveriza√ß√£o de tinta e outros",
    "Clay bar profissional",
    "Toque liso e brilho restaurado"
  ]
},

bancos: {
  titulo: "Higieniza√ß√£o e hidrata√ß√£o dos bancos de couro",
  itens: [
    "Higieniza√ß√£o profunda do couro",
    "Limpeza de poros",
    "Hidrata√ß√£o intensiva",
    "Prote√ß√£o contra ressecamento"
  ]
},

enceramento: {
    titulo: "Enceramento T√©cnico",
    itens: [
      "Lavagem t√©cnica preparat√≥ria",
      "Descontamina√ß√£o da pintura",
      "Aplica√ß√£o de cera ou selante t√©cnico profissional com politriz",
      "Prote√ß√£o contra raios UV",
      "Acabamento final com alto brilho"
    ]
},

  motor: {
    titulo: "Limpeza e Prote√ß√£o de Motor",
    itens: [
      "Isolamento das partes sens√≠veis",
      "Limpeza t√©cnica segura do cofre do motor",
      "Remo√ß√£o de graxa, poeira e sujeira",
      "Aplica√ß√£o de protetor em pl√°sticos e borrachas",
      "Acabamento final"
    ]
  },

  farol: {
    titulo: "Revitaliza√ß√£o de Far√≥is",
    itens: [
      "Lixamento t√©cnico progressivo",
      "Polimento profissional",
      "Aplica√ß√£o de prote√ß√£o UV",
      "Restaura√ß√£o da transpar√™ncia"
    ]
  },

  vidros: {
    titulo: "Cristaliza√ß√£o de Vidros",
    itens: [
      "Limpeza t√©cnica dos vidros",
      "Descontamina√ß√£o da superf√≠cie",
      "Aplica√ß√£o de produto hidrorrepelente",
      "Acabamento final"
    ]
  }
};

function abrirModal(servico) {
  document.getElementById("modalTitulo").innerText = servicos[servico].titulo;

  const lista = document.getElementById("modalLista");
  lista.innerHTML = "";

  servicos[servico].itens.forEach(item => {
    const li = document.createElement("li");
    li.textContent = item;
    lista.appendChild(li);
  });

  document.getElementById("modalDetalhes").style.display = "flex";
}

function fecharModal() {
  document.getElementById("modalDetalhes").style.display = "none";
}

window.onclick = function(event) {
  if (event.target == document.getElementById("modalDetalhes")) {
    fecharModal();
  }
}
</script>
</body>
</html>
